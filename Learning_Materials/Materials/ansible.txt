# Connect to all the systems and create ansible user (Optional & Recommended)

$ sudo useradd ansible
$ sudo passwd ansible	>> pwd & confirm pwd

$ sudo visudo
	ansible ALL=(ALL) NOPASSWD: ALL
$ sudo vi /etc/ssh/sshd_config
	Comment PasswordAuthentication no
	un-Comment passwordAuthentication yes
	Restart the server
$ sudo service sshd restart
Note: Do the above steps in all machines (server & hosts);

# Ansible Installation:
---------------------------
# Switch to ansible user
$ sudo su ansible
$ sudo yum install python3 -y
$ python3 --version
$ sudo alternatives --set python /usr/bin/python3 (Optional)
$ python --version (Optional)
$ sudo yum -y install python3-pip
$ pip3 install ansible --user
$ ansible --version
$ sudo mkdir /etc/ansible/
$ sudo vi /etc/ansible/ansible.cfg (Take examples from the below url)
$ sudo vi /etc/ansible/hosts (Take examples from the below url)

url: https://github.com/ansible/ansible/blob/stable-2.9/examples/ansible.cfg

#Generate SSH Key:
------------------------
$ sudo su ansible
$ ssh-keygen
$ ssh-copy-id ansible@172.31.46.123 (Host IP (For all hosts));

# pinging hosts:
ansible all -m ping


#example in hosts file:
---------------------------
172.31.1.38 ansible_user=ansible ansible_password=rootroot
172.31.8.14

#Examples:
---------------

$ ansible webservers -m shell -a 'date'
$ ansible all -m shell -a uptime
$ ansible -doc -l (available modules in ansible);
$ ansible-doc <modulename>
$ ansible-doc shell
$ ansible-doc -l | grep 'copy'
$ ansible-doc yum

ping module:
$ ansible all -m ping
$ ansible all -m ping -o (output in single line);
$ ansible all -m shell -a 'date'
$ ansible all -m shell -a 'cat /etc/*release'
$ ansible all -m shell -a 'mount' (kind of mount on all machines);
$ ansible all -b -m shell -a 'service sshd status' (service status);
$ ansible dbservers -a 'df-h' (disk space);
$ ansible webservers -a 'free -m' (disk space);
$ ansible webservers -a 'date'

yum module:
$ ansible all -b -m yum -a 'name=vim' (install vim editor)
$ ansible all -m shell -a 'git --version'
$ ansible all -m shell -b -a 'yum install git -y'
$ ansible webservers -m shell -b -a 'yum install git -y'
$ ansible 172.132.1.8 -m shell -b -a 'yum install git -y'
present: install;
latest: update to latest;
absent: un-install;
$ ansible all -m apt -a 'name=git state=latest' (Default is present)


#PlayBooks:
---------------
$ ansible-playbook ping.yml -v | -vv | -vvv (verbose for detailing);
$ ansible-playbook --help
$ ansible-playbook ping.yml --syntax-check
$ ansible-playbook ping.yml --check (dry run)
$ ansible-playbook ping.yml --list-hosts (list of effecting hosts);
$ ansible-playbook ping.yml --step (step by step run);

#Samples for playbooks:
-----------------------------
# to ping all host nodes
---
- hosts: all
  tasks:
  - name: ping all host nodes
    ping:
    remote_user: ansible
---
#to create a file
---
- hosts: all
  tasks: 
  - name: create file in host nodes
    file:
     path: /home/ansible/hello.txt\
     state: touch
---
# to copy content
---
- hosts: all
  tasks: 
  - name: copy content to a file
    copy: content='Hello World \n' dest='/home/ansible/hello.txt'
--- 
# to install httpd package
---
- hosts: all
  become: true
  tasks:
  - name: install httpd package
    yum:
     name: httpd
     state: latest
---
# to install and start the httpd
---
- hosts: all
  become: true
  tasks: 
  - name: install httpd package
    yum:
     name: httpd
     state: latest
  - name: start httpd server\
    service: 
     name: httpd
     state: started
---
# to install httpd, copy index.html & start httpd server
# note: need to create index.html file;
---
- hosts: all
  become: true
  tasks: 
  - name: install httpd package
    yum:
     name: httpd
     state: latest
  - name: copy index.html file
    copy: 
     src: index.html
     dest: /var/www/html/index.html
  - name: start httpd service
    service: 
     name: httpd
     state: started
---






















